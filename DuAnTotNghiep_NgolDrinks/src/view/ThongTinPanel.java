/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package view;

import Connect.DBConnection;

import javax.swing.*;
import java.awt.*;
import java.sql.*;
/**
 *
 * @author Admin
 */
public class ThongTinPanel extends javax.swing.JPanel {

    /**
     * Creates new form ThongTinPanel
     */
    private JTextField txtEmail, txtHoTen, txtNgaySinh, txtSdt, txtDiaChi, txtGioiTinh;
    private String emailDangNhap;

    public ThongTinPanel(String emailDangNhap) {
        this.emailDangNhap = emailDangNhap;

        setLayout(new GridLayout(6, 2, 10, 10));
        setBorder(BorderFactory.createTitledBorder("Th√¥ng tin t√†i kho·∫£n"));

        // üü¶ Label v√† TextField
        add(new JLabel("Email:"));
        txtEmail = createDisabledField();
        add(txtEmail);

        add(new JLabel("H·ªç t√™n:"));
        txtHoTen = createDisabledField();
        add(txtHoTen);

        add(new JLabel("Ng√†y sinh:"));
        txtNgaySinh = createDisabledField();
        add(txtNgaySinh);

        add(new JLabel("S·ªë ƒëi·ªán tho·∫°i:"));
        txtSdt = createDisabledField();
        add(txtSdt);

        add(new JLabel("ƒê·ªãa ch·ªâ:"));
        txtDiaChi = createDisabledField();
        add(txtDiaChi);

        add(new JLabel("Gi·ªõi t√≠nh:"));
        txtGioiTinh = createDisabledField();
        add(txtGioiTinh);

        // üü¶ Load d·ªØ li·ªáu t·ª´ DB
        loadThongTin();
    }

    private JTextField createDisabledField() {
        JTextField field = new JTextField();
        field.setEnabled(false); // ‚ùå Kh√¥ng cho ph√©p nh·∫≠p
        field.setDisabledTextColor(Color.BLACK); // M√†u ch·ªØ khi disabled
        field.setBackground(new Color(230, 230, 230)); // M√†u n·ªÅn nh·∫π
        return field;
    }

    private void loadThongTin() {
        try (Connection conn = DBConnection.getConnect()) {
            String sql = """
                SELECT tk.Email, nd.Hoten, nd.NgaySinh, nd.Sdt, nd.DiaChi, nd.GioiTinh
                FROM Taikhoan tk
                JOIN Nguoidung nd ON tk.Manguoidung = nd.Manguoidung
                WHERE tk.Email = ?
            """;
            PreparedStatement pst = conn.prepareStatement(sql);
            pst.setString(1, emailDangNhap);
            ResultSet rs = pst.executeQuery();
            if (rs.next()) {
                txtEmail.setText(rs.getString("Email"));
                txtHoTen.setText(rs.getString("Hoten"));
                txtNgaySinh.setText(rs.getDate("NgaySinh").toString());
                txtSdt.setText(rs.getString("Sdt"));
                txtDiaChi.setText(rs.getString("DiaChi"));
                txtGioiTinh.setText(rs.getString("GioiTinh"));
            } else {
                JOptionPane.showMessageDialog(this, "Kh√¥ng t√¨m th·∫•y th√¥ng tin t√†i kho·∫£n!", "L·ªói", JOptionPane.ERROR_MESSAGE);
            }
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "L·ªói t·∫£i th√¥ng tin: " + e.getMessage(), "L·ªói", JOptionPane.ERROR_MESSAGE);
        }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );
    }// </editor-fold>//GEN-END:initComponents


    // Variables declaration - do not modify//GEN-BEGIN:variables
    // End of variables declaration//GEN-END:variables
}
